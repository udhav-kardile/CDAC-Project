<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delivery Delay Prevention - E-commerce Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #333;
        }
        .section-heading {
            position: relative;
            display: inline-block;
            padding-bottom: 8px;
        }
        .section-heading::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 70%;
            height: 3px;
            background-color: #6366f1;
            border-radius: 9999px;
        }
        pre {
            background-color: #2d3748; /* Darker background for code */
            color: #e2e8f0; /* Light text for code */
            padding: 1.5rem;
            border-radius: 0.5rem;
            overflow-x: auto; /* Enable horizontal scrolling for long lines */
            font-family: 'Fira Code', 'Cascadia Code', monospace; /* Monospace font */
            font-size: 0.9rem;
            line-height: 1.5;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    {% extends "base.html" %}

{% block title %}Delivery Delay Prevention - E-commerce Intelligence{% endblock %}

{% block content %}
    <h2 class="section-heading text-5xl font-extrabold text-gray-900 mb-12 text-center">Delivery Delay Prevention</h2>

    <div class="bg-white rounded-lg shadow-xl p-8 mb-12">
        <h3 class="text-3xl font-bold text-gray-800 mb-6">Feature Overview & Details</h3>
        <p class="text-lg text-gray-700 leading-relaxed mb-4">
            Our **Delivery Delay Analysis module** is designed to identify and predict potential bottlenecks within the e-commerce delivery logistics, helping businesses understand and mitigate shipment delays.
        </p>

        <div class="mt-8">
            <h4 class="text-2xl font-bold text-gray-800 mb-4">1. Purpose & Motivation</h4>
            <p class="text-lg text-gray-700 leading-relaxed mb-4">
                <strong>Problem Solved:</strong> Late deliveries significantly impact customer satisfaction and can lead to negative reviews, refunds, and lost business. Manually tracking and predicting these delays is impossible at scale. This module provides insights to proactively address delivery risks.
            </p>
            <p class="text-lg text-gray-700 leading-relaxed mb-4">
                <strong>Actionable Insights:</strong> It helps businesses by:
            </p>
            <ul class="list-disc list-inside text-lg text-gray-700 space-y-2 mb-6 ml-4">
                <li>Identifying high-risk regions or problematic sellers/carriers.</li>
                <li>Anticipating delays for specific orders.</li>
                <li>Enabling proactive customer communication about potential delays.</li>
                <li>Optimizing logistics routes and partner performance.</li>
            </ul>

            <h4 class="text-2xl font-bold text-gray-800 mb-4">2. Data Used</h4>
            <p class="text-lg text-gray-700 leading-relaxed mb-4">
                This module primarily relies on historical delivery data. Conceptually, it would draw from:
            </p>
            <ul class="list-disc list-inside text-lg text-gray-700 space-y-2 mb-6 ml-4">
                <li><strong>Orders Data (e.g., `orders.csv`):</strong> Containing order IDs, dates, estimated delivery dates, and actual delivery dates.</li>
                <li><strong>Seller Information (e.g., `sellers.csv`):</strong> Performance metrics, location.</li>
                <li><strong>Geographical Data:</strong> Region/city information.</li>
            </ul>
            <p class="text-lg text-gray-700 leading-relaxed mb-4">
                From this, key features like `delivery_delay` (calculated as `actual_delivery_date - estimated_delivery_date`) and patterns across various dimensions are derived.
            </p>

            <h4 class="text-2xl font-bold text-gray-800 mb-4">3. Analytical Approach & Underlying Mechanism</h4>
            <p class="text-lg text-gray-700 leading-relaxed mb-4">
                <strong>Core Strategy (Conceptual):</strong> My primary approach for robust delivery delay analysis is to leverage Spark SQL (as demonstrated in my `Spark_SQL_Delay_Delevery_Analysis.ipynb` notebook). Spark SQL is ideal for processing large volumes of structured and semi-structured delivery logs to:
            </p>
            <ul class="list-disc list-inside text-lg text-gray-700 space-y-2 mb-6 ml-4">
                <li>Perform complex joins and aggregations across massive datasets.</li>
                <li>Identify historical patterns of delays based on region, seller_id, product_category, delivery method, and seasonal factors.</li>
                <li>Derive statistical insights into average delays, outlier delays, and the probability of delay for specific routes/partners.</li>
                <li>Ultimately, pre-compute "risk zones" or predictive rules.</li>
            </ul>
        </div>

        <p class="text-lg text-gray-700 leading-relaxed mt-8 border-t pt-4">
            This proactive approach allows businesses to take timely corrective actions, such as
            rerouting packages, communicating transparently with customers about revised delivery times,
            or offering alternative solutions. Minimizing delivery disruptions significantly enhances customer
            satisfaction, reduces support inquiries, and protects brand reputation.
        </p>
    </div>

    {# Real-time prediction form for delivery delay #}
    <div class="bg-white p-8 rounded-lg shadow-xl mb-12 max-w-3xl mx-auto">
        <h3 class="text-3xl font-bold text-gray-800 mb-6 text-center">Predict Delivery Risk</h3>
        <p class="text-lg text-gray-700 leading-relaxed mb-6 text-center">
            Enter details below to get an estimated delivery risk.
        </p>

        <form method="POST" action="{{ url_for('delivery_route') }}" class="space-y-6">
            <div class="form-group">
                <label for="region" class="text-lg">Region:</label>
                <input type="text" id="region" name="region" required
                       class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 shadow-sm text-gray-800"
                       placeholder="e.g., Mumbai" value="{{ request.form.get('region', '') }}">
            </div>
            <div class="form-group">
                <label for="seller_id" class="text-lg">Seller ID:</label>
                <input type="text" id="seller_id" name="seller_id" required
                       class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 shadow-sm text-gray-800"
                       placeholder="e.g., SellerX" value="{{ request.form.get('seller_id', '') }}">
            </div>
            <button type="submit" class="form-button form-button-primary w-full md:w-auto px-6 py-3 text-lg">Predict Risk</button>
        </form>

        {% if result %}
            <div class="result-box mt-8">
                <h3 class="text-2xl font-bold border-b pb-2 mb-4 border-blue-400">Prediction Result:</h3>
                {% if result.error %}
                    <p class="error-message text-red-700 text-lg"><strong>Error:</strong> {{ result.error }}</p>
                    <p class="text-gray-700 mt-2">Please check server logs for more details.</p>
                {% else %}
                    <p class="text-lg mb-2"><strong>Region:</strong> <span class="text-gray-800 italic">{{ result.region }}</span></p>
                    <p class="text-lg mb-2"><strong>Seller ID:</strong> <span class="text-gray-800 italic">{{ result.seller_id }}</span></p>
                    <p class="text-xl mb-2"><strong>Predicted Risk Level:</strong> <span class="font-bold {% if 'High' in result.risk_level or 'Critical' in result.risk_level %}text-red-600{% elif 'Medium' in result.risk_level %}text-yellow-600{% else %}text-green-600{% endif %}">
                        {{ result.risk_level }}
                    </span></p>
                    {% if result.notes %}
                        <p class="text-sm text-gray-600 mt-4">{{ result.notes }}</p>
                    {% endif %}
                {% endif %}
            </div>
        {% endif %}
    </div>

    <div class="bg-white rounded-lg shadow-xl p-8">
        <h3 class="text-3xl font-bold text-gray-800 mb-6">Dedicated Dashboard View</h3>
        <p class="text-lg text-gray-700 leading-relaxed mb-4">
            Explore a focused Power BI dashboard providing a real-time overview of potential delivery delays,
            risk assessments, and actionable insights to maintain delivery excellence.
        </p>
        <div class="bg-gray-100 rounded-lg shadow-md overflow-hidden h-[500px] md:h-[650px] flex items-center justify-center p-4">
            <iframe
                src="https://app.powerbi.com/reportEmbed?reportId=cf2bcca9-634d-47de-a554-a87340488e68&autoAuth=true&ctid=cc819eae-433f-4ebe-8a84-8e6f68ae7345"
                frameborder="0"
                allowFullScreen="true"
                class="w-full h-full"
            ></iframe>
        </div>
        <p class="text-center text-gray-600 mt-4">
            *Note: This is an example embed. Update the `src` attribute if you have a dedicated Power BI report.*
        </p>
    </div>
{% endblock %}

            <div class="bg-white rounded-lg shadow-xl p-8">
                <h3 class="text-3xl font-bold text-gray-800 mb-6">Dedicated Dashboard View</h3>
                <p class="text-lg text-gray-700 leading-relaxed mb-4">
                    Explore a focused Power BI dashboard providing a real-time overview of potential delivery delays,
                    risk assessments, and actionable insights to maintain delivery excellence.
                </p>
                <div class="bg-gray-100 rounded-lg shadow-md overflow-hidden h-[500px] md:h-[650px] flex items-center justify-center p-4">
                    <iframe
                        src="https://app.powerbi.com/reportEmbed?reportId=e921ef33-13f4-476b-9c61-836115565b2f&autoAuth=true&ctid=cc819eae-433f-4ebe-8a84-8e6f68ae7345&actionBarEnabled=true&filter=Reports/Delivery"
                        frameborder="0"
                        allowFullScreen="true"
                        class="w-full h-full"
                    ></iframe>
                </div>
                <p class="text-center text-gray-600 mt-4">
                    *Note: This is an example embed. Update the `src` attribute if you have a dedicated Power BI report.*
                </p>
            </div>

        </div>
    </main>

    <footer class="bg-gray-800 text-white py-8 px-6 mt-auto">
        <div class="container mx-auto text-center text-gray-400">
            <p>&copy; 2025 E-commerce Intelligence. All rights reserved.</p>
        </div>
    </footer>

</body>
</html>